# import httpx
from datetime import datetime

import requests as req

from src.project.config import settings
from src.core.schemas import WeatherDTO

OPENWEATHERMAP_API_KEY = ""

lat = 50.8055937
lon = 84.9462522

# OPENWEATHERMAP_URL = f"http://api.openweathermap.org/data/2.5/forecast?lat={lat}&lon={lon}&appid={OPENWEATHERMAP_API_KEY}"
OPENWEATHERMAP_URL = "http://api.openweathermap.org/data/2.5/forecast"

# response = req.get(url=OPENWEATHERMAP_URL)

# result_now = response.json()['list'][0]
# result_now_plus_3 = response.json()['list'][1]
# result_now_plus_6 = response.json()['list'][2]
# result_now_plus_9 = response.json()['list'][3]


# {'cod': '200', 'message': 0, 'cnt': 40, 'list':
# [
# {'dt': 1714845600, 'main':
# {'temp': 281.83, 'feels_like': 280.32, 'temp_min': 281.83, 'temp_max': 281.84, 'pressure': 1009, 'sea_level': 1009, 'grnd_level': 857, 'humidity': 73, 'temp_kf': -0.01}, 'weather':
# [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}],
# 'clouds': {'all': 99}, 'wind': {'speed': 2.63, 'deg': 174, 'gust': 2.63},
# 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'},
# 'dt_txt': '2024-05-04 18:00:00'},
# {'dt': 1714856400,
# 'main': {'temp': 280.43, 'feels_like': 278.27, 'temp_min': 279.73, 'temp_max': 280.43, 'pressure': 1010, 'sea_level': 1010, 'grnd_level': 856, 'humidity': 77, 'temp_kf': 0.7}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 94}, 'wind': {'speed': 3.2, 'deg': 182, 'gust': 3.45}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-04 21:00:00'},
# {'dt': 1714867200, 'main': {'temp': 280.35, 'feels_like': 278.13, 'temp_min': 280.35, 'temp_max': 280.35, 'pressure': 1010, 'sea_level': 1010, 'grnd_level': 856, 'humidity': 75, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'clouds': {'all': 94}, 'wind': {'speed': 3.26, 'deg': 183, 'gust': 3.89}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-05 00:00:00'}, {'dt': 1714878000, 'main': {'temp': 288.09, 'feels_like': 286.87, 'temp_min': 288.09, 'temp_max': 288.09, 'pressure': 1007, 'sea_level': 1007, 'grnd_level': 856, 'humidity': 47, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'clouds': {'all': 82}, 'wind': {'speed': 3.34, 'deg': 186, 'gust': 5.65}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-05 03:00:00'}, {'dt': 1714888800, 'main': {'temp': 293.21, 'feels_like': 292.05, 'temp_min': 293.21, 'temp_max': 293.21, 'pressure': 1004, 'sea_level': 1004, 'grnd_level': 855, 'humidity': 30, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'clouds': {'all': 81}, 'wind': {'speed': 5.83, 'deg': 193, 'gust': 10.48}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-05 06:00:00'}, {'dt': 1714899600, 'main': {'temp': 293.53, 'feels_like': 292.33, 'temp_min': 293.53, 'temp_max': 293.53, 'pressure': 1003, 'sea_level': 1003, 'grnd_level': 854, 'humidity': 27, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'clouds': {'all': 100}, 'wind': {'speed': 7.11, 'deg': 197, 'gust': 11.22}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-05 09:00:00'}, {'dt': 1714910400, 'main': {'temp': 292, 'feels_like': 290.96, 'temp_min': 292, 'temp_max': 292, 'pressure': 1003, 'sea_level': 1003, 'grnd_level': 853, 'humidity': 39, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'clouds': {'all': 93}, 'wind': {'speed': 5.8, 'deg': 200, 'gust': 10.58}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-05 12:00:00'}, {'dt': 1714921200, 'main': {'temp': 286.32, 'feels_like': 285.18, 'temp_min': 286.32, 'temp_max': 286.32, 'pressure': 1004, 'sea_level': 1004, 'grnd_level': 854, 'humidity': 57, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'clouds': {'all': 80}, 'wind': {'speed': 3.13, 'deg': 172, 'gust': 3.03}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-05 15:00:00'}, {'dt': 1714932000, 'main': {'temp': 284.67, 'feels_like': 283.55, 'temp_min': 284.67, 'temp_max': 284.67, 'pressure': 1005, 'sea_level': 1005, 'grnd_level': 853, 'humidity': 64, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 90}, 'wind': {'speed': 4.08, 'deg': 172, 'gust': 6.47}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-05 18:00:00'}, {'dt': 1714942800, 'main': {'temp': 287.28, 'feels_like': 286.18, 'temp_min': 287.28, 'temp_max': 287.28, 'pressure': 1004, 'sea_level': 1004, 'grnd_level': 854, 'humidity': 55, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 99}, 'wind': {'speed': 4.83, 'deg': 212, 'gust': 11.08}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-05 21:00:00'}, {'dt': 1714953600, 'main': {'temp': 284.8, 'feels_like': 284.06, 'temp_min': 284.8, 'temp_max': 284.8, 'pressure': 1009, 'sea_level': 1009, 'grnd_level': 857, 'humidity': 78, 'temp_kf': 0}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'clouds': {'all': 99}, 'wind': {'speed': 5.85, 'deg': 243, 'gust': 13.6}, 'visibility': 10000, 'pop': 0.95, 'rain': {'3h': 1.35}, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-06 00:00:00'}, {'dt': 1714964400, 'main': {'temp': 278.1, 'feels_like': 274.53, 'temp_min': 278.1, 'temp_max': 278.1, 'pressure': 1017, 'sea_level': 1017, 'grnd_level': 861, 'humidity': 95, 'temp_kf': 0}, 'weather': [{'id': 501, 'main': 'Rain', 'description': 'moderate rain', 'icon': '10d'}], 'clouds': {'all': 100}, 'wind': {'speed': 4.78, 'deg': 348, 'gust': 4.44}, 'visibility': 265, 'pop': 1, 'rain': {'3h': 4.61}, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-06 03:00:00'}, {'dt': 1714975200, 'main': {'temp': 277.47, 'feels_like': 275.37, 'temp_min': 277.47, 'temp_max': 277.47, 'pressure': 1020, 'sea_level': 1020, 'grnd_level': 863, 'humidity': 94, 'temp_kf': 0}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'clouds': {'all': 100}, 'wind': {'speed': 2.36, 'deg': 344, 'gust': 3.23}, 'visibility': 7469, 'pop': 1, 'rain': {'3h': 2.24}, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-06 06:00:00'}, {'dt': 1714986000, 'main': {'temp': 277.47, 'feels_like': 275.5, 'temp_min': 277.47, 'temp_max': 277.47, 'pressure': 1021, 'sea_level': 1021, 'grnd_level': 864, 'humidity': 94, 'temp_kf': 0}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'clouds': {'all': 100}, 'wind': {'speed': 2.22, 'deg': 1, 'gust': 2.91}, 'visibility': 9288, 'pop': 1, 'rain': {'3h': 1.32}, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-06 09:00:00'}, {'dt': 1714996800, 'main': {'temp': 277.27, 'feels_like': 275.31, 'temp_min': 277.27, 'temp_max': 277.27, 'pressure': 1024, 'sea_level': 1024, 'grnd_level': 866, 'humidity': 95, 'temp_kf': 0}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'clouds': {'all': 100}, 'wind': {'speed': 2.18, 'deg': 357, 'gust': 2.76}, 'visibility': 10000, 'pop': 1, 'rain': {'3h': 0.25}, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-06 12:00:00'}, {'dt': 1715007600, 'main': {'temp': 276.59, 'feels_like': 274.03, 'temp_min': 276.59, 'temp_max': 276.59, 'pressure': 1026, 'sea_level': 1026, 'grnd_level': 868, 'humidity': 96, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 100}, 'wind': {'speed': 2.7, 'deg': 348, 'gust': 3.26}, 'visibility': 4688, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-06 15:00:00'}, {'dt': 1715018400, 'main': {'temp': 276.08, 'feels_like': 273.72, 'temp_min': 276.08, 'temp_max': 276.08, 'pressure': 1028, 'sea_level': 1028, 'grnd_level': 869, 'humidity': 97, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 100}, 'wind': {'speed': 2.37, 'deg': 353, 'gust': 2.88}, 'visibility': 3953, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-06 18:00:00'}, {'dt': 1715029200, 'main': {'temp': 275.73, 'feels_like': 273.44, 'temp_min': 275.73, 'temp_max': 275.73, 'pressure': 1029, 'sea_level': 1029, 'grnd_level': 870, 'humidity': 96, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 100}, 'wind': {'speed': 2.24, 'deg': 353, 'gust': 2.75}, 'visibility': 5046, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-06 21:00:00'}, {'dt': 1715040000, 'main': {'temp': 276.02, 'feels_like': 274.73, 'temp_min': 276.02, 'temp_max': 276.02, 'pressure': 1029, 'sea_level': 1029, 'grnd_level': 870, 'humidity': 93, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'clouds': {'all': 100}, 'wind': {'speed': 1.46, 'deg': 12, 'gust': 1.46}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-07 00:00:00'}, {'dt': 1715050800, 'main': {'temp': 278.24, 'feels_like': 278.24, 'temp_min': 278.24, 'temp_max': 278.24, 'pressure': 1028, 'sea_level': 1028, 'grnd_level': 870, 'humidity': 82, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'clouds': {'all': 100}, 'wind': {'speed': 0.74, 'deg': 77, 'gust': 1.35}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-07 03:00:00'}, {'dt': 1715061600, 'main': {'temp': 284.93, 'feels_like': 283.68, 'temp_min': 284.93, 'temp_max': 284.93, 'pressure': 1023, 'sea_level': 1023, 'grnd_level': 869, 'humidity': 58, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'clouds': {'all': 81}, 'wind': {'speed': 2.2, 'deg': 159, 'gust': 2.92}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-07 06:00:00'}, {'dt': 1715072400, 'main': {'temp': 288.55, 'feels_like': 287.16, 'temp_min': 288.55, 'temp_max': 288.55, 'pressure': 1020, 'sea_level': 1020, 'grnd_level': 867, 'humidity': 39, 'temp_kf': 0}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'clouds': {'all': 40}, 'wind': {'speed': 3.17, 'deg': 188, 'gust': 3.94}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-07 09:00:00'}, {'dt': 1715083200, 'main': {'temp': 287.62, 'feels_like': 286.43, 'temp_min': 287.62, 'temp_max': 287.62, 'pressure': 1019, 'sea_level': 1019, 'grnd_level': 866, 'humidity': 50, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'clouds': {'all': 69}, 'wind': {'speed': 2.24, 'deg': 186, 'gust': 4.17}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-07 12:00:00'}, {'dt': 1715094000, 'main': {'temp': 283.69, 'feels_like': 282.37, 'temp_min': 283.69, 'temp_max': 283.69, 'pressure': 1020, 'sea_level': 1020, 'grnd_level': 866, 'humidity': 60, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 99}, 'wind': {'speed': 2.45, 'deg': 182, 'gust': 2.27}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-07 15:00:00'}, {'dt': 1715104800, 'main': {'temp': 281.35, 'feels_like': 280.5, 'temp_min': 281.35, 'temp_max': 281.35, 'pressure': 1020, 'sea_level': 1020, 'grnd_level': 866, 'humidity': 66, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 100}, 'wind': {'speed': 1.73, 'deg': 199, 'gust': 1.9}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-07 18:00:00'}, {'dt': 1715115600, 'main': {'temp': 279.99, 'feels_like': 279.99, 'temp_min': 279.99, 'temp_max': 279.99, 'pressure': 1021, 'sea_level': 1021, 'grnd_level': 866, 'humidity': 71, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 100}, 'wind': {'speed': 0.76, 'deg': 227, 'gust': 1.26}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-07 21:00:00'}, {'dt': 1715126400, 'main': {'temp': 280.52, 'feels_like': 279.42, 'temp_min': 280.52, 'temp_max': 280.52, 'pressure': 1023, 'sea_level': 1023, 'grnd_level': 867, 'humidity': 75, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'clouds': {'all': 100}, 'wind': {'speed': 1.85, 'deg': 357, 'gust': 2.34}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-08 00:00:00'}, {'dt': 1715137200, 'main': {'temp': 284.04, 'feels_like': 282.91, 'temp_min': 284.04, 'temp_max': 284.04, 'pressure': 1022, 'sea_level': 1022, 'grnd_level': 868, 'humidity': 66, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'clouds': {'all': 68}, 'wind': {'speed': 2.17, 'deg': 359, 'gust': 2.52}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-08 03:00:00'}, {'dt': 1715148000, 'main': {'temp': 287.48, 'feels_like': 286.17, 'temp_min': 287.48, 'temp_max': 287.48, 'pressure': 1021, 'sea_level': 1021, 'grnd_level': 868, 'humidity': 46, 'temp_kf': 0}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'clouds': {'all': 39}, 'wind': {'speed': 2.59, 'deg': 2, 'gust': 2.93}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-08 06:00:00'}, {'dt': 1715158800, 'main': {'temp': 288.62, 'feels_like': 287.19, 'temp_min': 288.62, 'temp_max': 288.62, 'pressure': 1021, 'sea_level': 1021, 'grnd_level': 868, 'humidity': 37, 'temp_kf': 0}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'clouds': {'all': 48}, 'wind': {'speed': 4.8, 'deg': 14, 'gust': 4.4}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-08 09:00:00'}, {'dt': 1715169600, 'main': {'temp': 286.52, 'feels_like': 285.14, 'temp_min': 286.52, 'temp_max': 286.52, 'pressure': 1022, 'sea_level': 1022, 'grnd_level': 868, 'humidity': 47, 'temp_kf': 0}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'clouds': {'all': 34}, 'wind': {'speed': 4.27, 'deg': 6, 'gust': 4.29}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-08 12:00:00'}, {'dt': 1715180400, 'main': {'temp': 281.65, 'feels_like': 280.39, 'temp_min': 281.65, 'temp_max': 281.65, 'pressure': 1025, 'sea_level': 1025, 'grnd_level': 869, 'humidity': 71, 'temp_kf': 0}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01n'}], 'clouds': {'all': 4}, 'wind': {'speed': 2.24, 'deg': 343, 'gust': 2.22}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-08 15:00:00'}, {'dt': 1715191200, 'main': {'temp': 279.52, 'feels_like': 278.73, 'temp_min': 279.52, 'temp_max': 279.52, 'pressure': 1025, 'sea_level': 1025, 'grnd_level': 869, 'humidity': 85, 'temp_kf': 0}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01n'}], 'clouds': {'all': 2}, 'wind': {'speed': 1.44, 'deg': 338, 'gust': 1.27}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-08 18:00:00'}, {'dt': 1715202000, 'main': {'temp': 278.37, 'feels_like': 278.37, 'temp_min': 278.37, 'temp_max': 278.37, 'pressure': 1025, 'sea_level': 1025, 'grnd_level': 868, 'humidity': 88, 'temp_kf': 0}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'clouds': {'all': 26}, 'wind': {'speed': 0.41, 'deg': 107, 'gust': 0.44}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-08 21:00:00'}, {'dt': 1715212800, 'main': {'temp': 279.56, 'feels_like': 279.56, 'temp_min': 279.56, 'temp_max': 279.56, 'pressure': 1024, 'sea_level': 1024, 'grnd_level': 868, 'humidity': 79, 'temp_kf': 0}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02d'}], 'clouds': {'all': 17}, 'wind': {'speed': 1, 'deg': 135, 'gust': 1.01}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-09 00:00:00'}, {'dt': 1715223600, 'main': {'temp': 285.67, 'feels_like': 284.28, 'temp_min': 285.67, 'temp_max': 285.67, 'pressure': 1021, 'sea_level': 1021, 'grnd_level': 867, 'humidity': 50, 'temp_kf': 0}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'clouds': {'all': 45}, 'wind': {'speed': 1.2, 'deg': 151, 'gust': 1.62}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-09 03:00:00'}, {'dt': 1715234400, 'main': {'temp': 291.86, 'feels_like': 290.57, 'temp_min': 291.86, 'temp_max': 291.86, 'pressure': 1017, 'sea_level': 1017, 'grnd_level': 865, 'humidity': 30, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'clouds': {'all': 58}, 'wind': {'speed': 0.73, 'deg': 113, 'gust': 1.35}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-09 06:00:00'}, {'dt': 1715245200, 'main': {'temp': 294.39, 'feels_like': 293.17, 'temp_min': 294.39, 'temp_max': 294.39, 'pressure': 1015, 'sea_level': 1015, 'grnd_level': 864, 'humidity': 23, 'temp_kf': 0}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02d'}], 'clouds': {'all': 18}, 'wind': {'speed': 0.3, 'deg': 42, 'gust': 1.34}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-09 09:00:00'}, {'dt': 1715256000, 'main': {'temp': 293.04, 'feels_like': 291.95, 'temp_min': 293.04, 'temp_max': 293.04, 'pressure': 1014, 'sea_level': 1014, 'grnd_level': 863, 'humidity': 33, 'temp_kf': 0}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'clouds': {'all': 59}, 'wind': {'speed': 0.8, 'deg': 1, 'gust': 1.22}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'd'}, 'dt_txt': '2024-05-09 12:00:00'}, {'dt': 1715266800, 'main': {'temp': 287.68, 'feels_like': 286.23, 'temp_min': 287.68, 'temp_max': 287.68, 'pressure': 1014, 'sea_level': 1014, 'grnd_level': 862, 'humidity': 40, 'temp_kf': 0}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'clouds': {'all': 100}, 'wind': {'speed': 0.87, 'deg': 149, 'gust': 0.93}, 'visibility': 10000, 'pop': 0, 'sys': {'pod': 'n'}, 'dt_txt': '2024-05-09 15:00:00'}], 'city': {'id': 1488190, 'name': "Ust'-Kan", 'coord': {'lat': 50.8056, 'lon': 84.9463}, 'country': 'RU', 'population': 3547, 'timezone': 25200, 'sunrise': 1714776514, 'sunset': 1714830318}}


class LLMWorker:
    def __init__(
            self,
            url: str,
            token: str,
    ):
        self._url = url
        self._token = token

    def get_weather(
            self,
            lat: float,
            lon: float,
    ):
        response = req.get(
            url=self._url,
            params={
                "lat": lat,
                "lon": lon,
                "appid": self._token,
            }
        )

        result_now = response.json()['list'][0]
        result_now_plus_3 = response.json()['list'][1]
        print(result_now)
        return result_now
        # print(result_now_plus_3)

    # async def get_weather(self) -> dict:
    #     res = await httpx.post(url=self._url, headers=self._headers)
    #     return res.json()


weather_worker = LLMWorker(
    url=OPENWEATHERMAP_URL,
    token=settings.weather_token,
)

weather_now = weather_worker.get_weather(lat=lat, lon=lon)

weather_now = WeatherDTO(
    time=datetime.fromtimestamp(weather_now['dt']).time(),
    temperature=weather_now['main']['temp'],
    feels_like=weather_now['main']['feels_like'],
    humidity=weather_now['main']['humidity'],
    weather=[weather['main'] for weather in weather_now['weather']],
    wind=weather_now['wind']['speed'],
)

print(weather_now)
